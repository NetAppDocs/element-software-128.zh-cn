---
permalink: concepts/concept_data_manage_volumes_solidfire_quality_of_service.html 
sidebar: sidebar 
keywords: solidfire, element, qos, performance, iops 
summary: 'SolidFire存储集群能够按卷提供服务质量 (QoS) 参数。您可以使用定义 QoS 的三个可配置参数来保证以每秒输入和输出 (IOPS) 衡量的集群性能：最小 IOPS、最大 IOPS 和突发 IOPS。' 
---
= 服务性能和质量
:allow-uri-read: 
:icons: font
:imagesdir: ../media/


[role="lead"]
SolidFire存储集群能够按卷提供服务质量 (QoS) 参数。您可以使用定义 QoS 的三个可配置参数来保证以每秒输入和输出 (IOPS) 衡量的集群性能：最小 IOPS、最大 IOPS 和突发 IOPS。


NOTE: SolidFire Active IQ有一个 QoS 建议页面，提供有关 QoS 设置的最佳配置和设置的建议。



== 服务质量参数

IOPS参数定义方式如下：

* *最小 IOPS* - 存储集群每秒向卷提供的最小持续输入和输出次数 (IOPS)。为卷配置的最小 IOPS 是该卷的保证性能水平。性能不会低于这个水平。
* *最大 IOPS* - 存储集群向卷提供的最大持续 IOPS 数。当集群 IOPS 水平达到极高水平时，不会超过此 IOPS 性能水平。
* *突发IOPS* - 在短时间内允许的最大突发IOPS数。如果卷的运行速度低于最大 IOPS，则会累积突发积分。当性能水平非常高并达到最大值时，允许卷上出现短时间的 IOPS 突发。
+
Element 软件在集群 IOPS 利用率较低时使用突发 IOPS。

+
单个卷可以累积突发 IOPS，并使用这些积分在设定的“突发周期”内将其 IOPS 提升至超过其最大 IOPS 水平，直至达到其突发 IOPS 水平。如果集群有容量容纳突发流量，则卷可以突发流量长达 60 秒。如果卷的运行速度低于其最大 IOPS 限制，则该卷每运行一秒，即可获得一秒的突发信用额度（最多 60 秒）。

+
突发 IOPS 受限于以下两个方面：

+
** 卷的突发性能可以超过其最大 IOPS，持续时间等于该卷已累积的突发信用数。
** 当某个音量达到其最大 IOPS 设置值以上时，它会受到其突发 IOPS 设置值的限制。因此，突发 IOPS 永远不会超过卷的突发 IOPS 设置值。


* *有效最大带宽* - 最大带宽是通过将 IOPS 数（基于 QoS 曲线）乘以 IO 大小来计算的。
+
例如：QoS 参数设置为 100 最小 IOPS、1000 最大 IOPS 和 1500 突发 IOPS，对性能质量有以下影响：

+
** 工作负载能够达到并维持最大 1000 IOPS，直到集群上出现工作负载争用 IOPS 的情况。然后逐步降低 IOPS，直到所有卷上的 IOPS 都达到指定的 QoS 范围，从而缓解性能争用。
** 所有卷的性能都力求达到最低 IOPS 100。当工作负载争用得到缓解时，IOPS 水平不会低于最小 IOPS 设置，但可能会高于 100 IOPS。
** 性能不会超过 1000 IOPS，也不会在一段时间内低于 100 IOPS。允许达到 1500 IOPS（突发 IOPS）的性能，但仅限于那些通过在低于最大 IOPS 的运行下积累突发积分的卷，并且只允许在短时间内使用。爆发强度永远不会持续。






== QoS 值限制

以下是 QoS 的可能最小值和最大值。

[cols="7*"]
|===
| 参数 | 最小值 | 默认 | 4.4KB | 5.8KB | 6 16KB | 262 KB 


| 最小 IOPS | 50 | 50 | 15,000 | 9,375* | 5556* | 385* 


| 最大 IOPS | 100 | 15,000 | 200,000** | 125,000 | 74,074 | 5128 


| 突发 IOPS | 100 | 15,000 | 200,000** | 125,000 | 74.074 | 5128 
|===
*这些估算值均为近似值。 **最大 IOPS 和突发 IOPS 可以设置为高达 200,000；但是，此设置仅允许有效地解除卷的性能限制。卷的实际最大性能受集群使用情况和单个节点性能的限制。



== 服务质量性能

QoS 性能曲线显示了块大小与 IOPS 百分比之间的关系。

数据块大小和带宽直接影响应用程序可获得的 IOPS 数量。 Element 软件会考虑接收到的块大小，并将块大小标准化为 4k。根据工作负载情况，系统可能会增加数据块大小。随着数据块大小的增加，系统会将带宽增加到足以处理更大数据块大小的水平。随着带宽的增加，系统能够达到的IOPS数量会减少。

QoS性能曲线显示了块大小增加与IOPS百分比下降之间的关系：

image::../media/solidfire_qos_performance_curve.png[描述了 QoS 中块大小增加与 IOPS 之间的关系。]

例如，如果块大小为 4k，带宽为 4000 KBps，则 IOPS 为 1000。如果块大小增加到 8k，带宽增加到 5000 KBps，IOPS 减少到 625。通过考虑数据块大小，该系统确保使用较大数据块大小的低优先级工作负载（例如备份和虚拟机管理程序活动）不会占用使用较小数据块大小的高优先级流量所需的过多性能。



== QoS 策略

QoS 策略允许您创建和保存可应用于多个卷的标准化服务质量设置。

QoS 策略最适合服务环境，例如数据库、应用程序或基础架构服务器，这些服务器很少重启，并且需要持续平等地访问存储。单个卷 QoS 最适合轻度使用的虚拟机，例如虚拟桌面或专用信息亭型虚拟机，这些虚拟机可能每天或一天多次重启、开机或关机。

QoS 和 QoS 策略不应该同时使用。如果您正在使用 QoS 策略，请不要在卷上使用自定义 QoS。自定义 QoS 将覆盖和调整卷 QoS 设置的 QoS 策略值。


NOTE: 要使用 QoS 策略，所选集群必须是 Element 10.0 或更高版本；否则，QoS 策略功能将不可用。



== 查找更多信息

* https://docs.netapp.com/us-en/element-software/index.html["SolidFire和 Element 软件文档"]

